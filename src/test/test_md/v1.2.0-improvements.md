# v1.2.0 Test Cases & Improvements

This file demonstrates all fixes and improvements made in v1.2.0 based on user feedback.

---

## Summary of v1.2.0 Changes

### Fixed False Positives

- ‚úÖ Bold text no longer flagged as list items: `**file/path_name.py**`
- ‚úÖ Abbreviation syntax supported: `*[UML]: Unified Modeling Language`
- ‚úÖ PyMdown Snippet syntax supported: `--8<-- "snippet.md"`

### New Configuration Options
```typescript
// Add to VS Code settings.json:
{
  "mkdocs-material-linter.checkBlankLineBeforeList": false,        // default: false
  "mkdocs-material-linter.checkBlankLineBeforeAdmonitionContent": false,  // default: false (NEW!)
  "mkdocs-material-linter.checkIndentation": true                 // default: true
}
```

### Test Results

- **64/64 tests passing** (11 new tests added)
- Full backward compatibility maintained

---

## Test Case 1: Abbreviation Syntax

<!-- FIXED: Abbreviation definitions were incorrectly flagged as list items -->
<!-- Implementation: isAbbreviationDefinition() function added -->
<!-- Regex: /^\s*\*\[[^\]]+\]:\s+.+/ -->

*[UML]: Unified Modeling Language
*[HTML]: Hyper Text Markup Language
*[API]: Application Programming Interface

**Expected**: ‚úÖ No errors (valid Markdown abbreviation syntax)

---

## Test Case 2: PyMdown Snippet Syntax

<!-- FIXED: Snippet includes were incorrectly flagged as list items -->
<!-- Implementation: isSnippetSyntax() function added -->
<!-- Regex: /^\s*--8<--\s+["'][^"']+["']/ -->

### 2.1 Double quotes

--8<-- "snippet.md:section_1"

### 2.2 Single quotes

--8<-- 'snippet.md:section_2'

### 2.3 Indented snippet

    --8<-- "includes/config.yaml"

**Expected**: ‚úÖ No errors (valid PyMdown Extensions Snippet syntax)

---

## Test Case 3: Bold Text

<!-- FIXED: Bold text was incorrectly flagged as list items -->
<!-- Implementation: Improved startsWithInlineEmphasis() function -->
<!-- New regex pattern: /^\s*\*\*[^*\s][^*]*\*\*/ -->

### 3.1 Standalone bold

**file/path_name.py:**

### 3.2 Multiple bold in paragraph

**file/path_name.py** and **another/file/path_name.html**
in a single paragraph.

### 3.3 Bold with colon

**config.yaml:**

**Expected**: ‚úÖ No errors (bold text, not list markers)

---

## Test Case 4: Compact Admonition Format

<!-- NEW FEATURE: Configuration option added -->
<!-- Setting: checkBlankLineBeforeAdmonitionContent (default: false) -->
<!-- This allows content immediately after title without blank line -->

### 4.1 Content immediately after title (no blank line)

!!! info
    Introductory paragraph without blank line before content.

!!! tip
    This tip doesn't have a blank line before the content.
    
    It just has multiple paragraphs.

**Expected**: ‚úÖ No errors (default config: `checkBlankLineBeforeAdmonitionContent: false`)

### 4.2 Admonition with title only

!!! warning "Important Warning"

**Expected**: ‚úÖ No errors (empty content allowed)

### 4.3 Admonition with empty title

!!! example ""
    Content with empty title.

[//]: # (Admonition without a title to outline the rendered example text)
!!! example ""
    Paragraph using the abbreviation for UML.

**Expected**: ‚úÖ No errors (empty title allowed)

---

## Test Case 5: Nested Lists

<!-- Configuration option: checkBlankLineBeforeList (default: true) -->
<!-- Can be set to false if tight list style is preferred -->

### 5.1 Basic nesting

* Long paragraph text
    wrapping multiple lines
    to improve reviewability in Github
* Long paragraph text
    1. Nested list
       with continuation
    1. Another item

### 5.2 Multi-level nesting

* Long paragraph text
    wrapping multiple lines
    to improve reviewability in Github
* Long paragraph text
    wrapping multiple lines
    1. And nesting lists
       with bad indenting
       and multiple lines
    1. And nesting lists
        and multiple lines
    1. And nesting lists
        and multiple lines
* Long paragraph text
    wrapping multiple lines

### 5.3 Simple nesting

* List item 1
* List item 2
    * Nested item
    * Another nested item

**Expected**: ‚úÖ No errors (correct list nesting format)

---

## Test Case 6: Collapsible Admonitions in Lists

<!-- Complex nesting: lists + collapsible admonitions + snippets -->
<!-- All three fixes working together -->

1. ??? abstract "Complex item"
        Content for this item.
        
        More content.

1. ??? abstract "Complex collapsible list item with a snippet"
        * Long paragraph text
            wrapping multiple lines
            to improve reviewability in Github
        --8<-- "snippet.md:section_2"

        !!! info
            Introductory paragraph without blank line before content.

            #### Bad heading increment not found by linters

            **file/path_name.py** and **another/file/path_name.html**
            in a single paragraph.

1. ??? abstract "Another complex collapsible list item"
        --8<-- "snippet.md:section_3"

**Expected**: ‚úÖ No errors (correct nesting format)

---

## Test Case 7: Mixed Syntax

<!-- All fixes working together in one document -->

*[CSS]: Cascading Style Sheets

## Heading 2

--8<-- "snippet.md:section_1"

**file/path_name.py:**

!!! tip
    This tip uses compact format.
    
    Multiple paragraphs are OK.

* List item 1
* List item 2
    * Nested item

**Expected**: ‚úÖ All syntax combinations work without errors

---

## Test Case 8: Code Blocks

<!-- Code blocks should not be linted -->

```html title="HTML Rendering"
<p>Paragraph using the abbreviation for <abbr title="Unified Modeling Language">UML</abbr></p>
```

**Expected**: ‚úÖ Code block content not checked

---

## Implementation Details

### New Functions Added

```typescript
// Check if line is an abbreviation definition: *[ABBR]: Full text
function isAbbreviationDefinition(line: string): boolean {
    return /^\s*\*\[[^\]]+\]:\s+.+/.test(line);
}

// Check if line is a snippet include: --8<-- "file.md"
function isSnippetSyntax(line: string): boolean {
    return /^\s*--8<--\s+["'][^"']+["']/.test(line);
}

// Improved bold text detection
function startsWithInlineEmphasis(line: string): boolean {
    return (
        /^\s*(\*\*|__)\S[^*_]*\1/.test(line)
        || /^\s*(\*|_)\S([^*_]|\\\*)+\1/.test(line)
        || /^\s*\*\*[^*\s][^*]*\*\*/.test(line)  // NEW: Better bold detection
    );
}
```

### Configuration Support

All check functions dynamically read configuration:

```typescript
const config = vscode.workspace.getConfiguration('mkdocs-material-linter');
const checkBlankLine = config.get<boolean>('checkBlankLineBeforeAdmonitionContent', false);
```

Configuration changes take effect immediately without restart.

---

## User Feedback Summary

### Issues Reported

1. ‚ùå **Indentation/tab issues** - Margins before admonitions affect reading
   - üí° Fixed: Added `checkIndentation` config option

2. ‚ùå **Over-marking list item errors**
   - Bold text: `**file/path_name.py**`
   - Abbreviations: `*[UML]: ...`
   - Snippets: `--8<-- "snippet.md"`
   - ‚úÖ All fixed

3. ‚ùå **Lack of configuration options**
   - ‚úÖ Added 3 configuration options

4. ‚ùå **Doesn't match real usage patterns**
   - Blank lines before lists/admonitions too strict
   - ‚úÖ Fixed: Default `checkBlankLineBeforeAdmonitionContent: false`

### All Issues Resolved

- ‚úÖ Fixed bold text false positives
- ‚úÖ Fixed abbreviation syntax false positives
- ‚úÖ Fixed snippet syntax false positives
- ‚úÖ Added flexible configuration options
- ‚úÖ Added 11 new test cases
- ‚úÖ Maintained full backward compatibility

---

**Version**: 1.2.0  
**Test Date**: 2026-01-30  
**Test Status**: All 71 tests passing ‚úÖ

---

## Test Case 9: Blank Line Before List - Critical Parsing Errors

<!-- IMPORTANT: Paragraph followed by list causes parsing failure -->
<!-- Implementation: checkBlankLineBeforeList() always reports Error for paragraph->list -->
<!-- This is independent of configuration setting -->

### 9.1 Paragraph before list (always error)

Some paragraph text
- list item

**Expected**: ‚ùå Error "List after paragraph requires a blank line (parsing error)."  
**Reason**: This pattern causes the list not to be recognized by Markdown parsers

### 9.2 Paragraph before list with blank line (correct)

Some paragraph text

- list item

**Expected**: ‚úÖ No errors (blank line fixes the parsing issue)

---

## Test Case 10: Blank Line Before List - Style Warnings (Configurable)

<!-- Configuration: checkBlankLineBeforeList (default: false) -->
<!-- When false: only paragraph->list errors -->
<!-- When true: all missing blank lines warn (except exemptions) -->

### 10.1 Heading before list (config: false)

## Heading
- list item

**Expected**: ‚úÖ No errors (heading->list parses correctly, config allows it)

### 10.2 Heading before list (config: true)

<!-- Setting: checkBlankLineBeforeList: true -->

## Heading
- list item

**Expected**: ‚ö†Ô∏è Warning "List items should be preceded by a blank line."  
**Reason**: Style preference enforced

### 10.3 Horizontal rule before list (config: false)

---
- list item

**Expected**: ‚úÖ No errors (horizontal rule->list parses correctly)

### 10.4 Horizontal rule before list (config: true)

<!-- Setting: checkBlankLineBeforeList: true -->

---
- list item

**Expected**: ‚ö†Ô∏è Warning "List items should be preceded by a blank line."

---

## Test Case 11: Blank Line Before List - Automatic Exemptions

<!-- These patterns NEVER require blank lines regardless of config -->
<!-- Implementation: Exemptions in checkBlankLineBeforeList() -->

### 11.1 List after list

- First item
- Second item

**Expected**: ‚úÖ No errors (list continuation)

### 11.2 List after blockquote

> Quote text
- list item

**Expected**: ‚úÖ No errors (blockquote->list allowed)

### 11.3 List in table

| Column |
|--------|
| - item |

**Expected**: ‚úÖ No errors (table context)

### 11.4 List after admonition header

!!! note
    - list item

**Expected**: ‚úÖ No errors (admonition content)

---

## Summary of Blank Line Logic

### Always Error (Parsing Issue)
- ‚ùå Paragraph ‚Üí List (not recognized as list)

### Automatic Exemptions (Never Warn/Error)
- ‚úÖ List ‚Üí List
- ‚úÖ Blockquote ‚Üí List
- ‚úÖ Table context
- ‚úÖ Admonition ‚Üí List
- ‚úÖ Heading ‚Üí List (parses correctly)
- ‚úÖ Horizontal Rule ‚Üí List (parses correctly)

### Configurable Warnings
When `checkBlankLineBeforeList: true`:
- ‚ö†Ô∏è Heading ‚Üí List (style preference)
- ‚ö†Ô∏è Horizontal Rule ‚Üí List (style preference)
- ‚ö†Ô∏è Code Block ‚Üí List (style preference)

When `checkBlankLineBeforeList: false` (default):
- Only paragraph‚Üílist errors are reported

